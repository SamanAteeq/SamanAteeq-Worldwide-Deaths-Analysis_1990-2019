{
	"name": "df_population",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "CountryList",
						"type": "DatasetReference"
					},
					"name": "sourcecountrylist"
				},
				{
					"dataset": {
						"referenceName": "CountriesbyPopulation",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AnnualDeathsbyCauseTransformed",
						"type": "DatasetReference"
					},
					"name": "sink2"
				}
			],
			"transformations": [
				{
					"name": "Select3"
				},
				{
					"name": "Unpivot2"
				},
				{
					"name": "Join2"
				},
				{
					"name": "Select7"
				}
			],
			"script": "source(output(\n\t\tId as integer,\n\t\tCountry as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\twildcardPaths:['CountryList.csv'],\n\tpartitionBy('hash', 1)) ~> sourcecountrylist\nsource(output(\n\t\t{Country Name} as string,\n\t\t{Country Code} as string,\n\t\t{Indicator Name} as string,\n\t\t{Indicator Code} as string,\n\t\t{1960} as long,\n\t\t{1961} as long,\n\t\t{1962} as long,\n\t\t{1963} as long,\n\t\t{1964} as long,\n\t\t{1965} as long,\n\t\t{1966} as long,\n\t\t{1967} as long,\n\t\t{1968} as long,\n\t\t{1969} as long,\n\t\t{1970} as long,\n\t\t{1971} as long,\n\t\t{1972} as long,\n\t\t{1973} as long,\n\t\t{1974} as long,\n\t\t{1975} as long,\n\t\t{1976} as long,\n\t\t{1977} as long,\n\t\t{1978} as long,\n\t\t{1979} as long,\n\t\t{1980} as long,\n\t\t{1981} as long,\n\t\t{1982} as long,\n\t\t{1983} as long,\n\t\t{1984} as long,\n\t\t{1985} as long,\n\t\t{1986} as long,\n\t\t{1987} as long,\n\t\t{1988} as long,\n\t\t{1989} as long,\n\t\t{1990} as long,\n\t\t{1991} as long,\n\t\t{1992} as long,\n\t\t{1993} as long,\n\t\t{1994} as long,\n\t\t{1995} as long,\n\t\t{1996} as long,\n\t\t{1997} as long,\n\t\t{1998} as long,\n\t\t{1999} as long,\n\t\t{2000} as long,\n\t\t{2001} as long,\n\t\t{2002} as long,\n\t\t{2003} as long,\n\t\t{2004} as long,\n\t\t{2005} as long,\n\t\t{2006} as long,\n\t\t{2007} as long,\n\t\t{2008} as long,\n\t\t{2009} as long,\n\t\t{2010} as long,\n\t\t{2011} as long,\n\t\t{2012} as long,\n\t\t{2013} as long,\n\t\t{2014} as long,\n\t\t{2015} as long,\n\t\t{2016} as long,\n\t\t{2017} as long,\n\t\t{2018} as long,\n\t\t{2019} as long,\n\t\t{2020} as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source1\nsource1 select(mapColumn(\n\t\tCountry = {Country Name},\n\t\t{1990},\n\t\t{1991},\n\t\t{1992},\n\t\t{1993},\n\t\t{1994},\n\t\t{1995},\n\t\t{1996},\n\t\t{1997},\n\t\t{1998},\n\t\t{1999},\n\t\t{2000},\n\t\t{2001},\n\t\t{2002},\n\t\t{2003},\n\t\t{2004},\n\t\t{2005},\n\t\t{2006},\n\t\t{2007},\n\t\t{2008},\n\t\t{2009},\n\t\t{2010},\n\t\t{2011},\n\t\t{2012},\n\t\t{2013},\n\t\t{2014},\n\t\t{2015},\n\t\t{2016},\n\t\t{2017},\n\t\t{2018},\n\t\t{2019}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nSelect3 unpivot(output(\n\t\tYear as integer,\n\t\tPopulation as long\n\t),\n\tungroupBy(Country),\n\tlateral: false,\n\tignoreNullPivots: false) ~> Unpivot2\nUnpivot2, sourcecountrylist join(Unpivot2@Country == sourcecountrylist@Country,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin2 select(mapColumn(\n\t\tPopulation,\n\t\tCountry = sourcecountrylist@Country,\n\t\tYear\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select7\nSelect7 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tpartitionFileNames:['transformed-country-by-population.csv'],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\tpartitionBy('hash', 1)) ~> sink2"
		}
	}
}